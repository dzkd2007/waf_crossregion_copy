{
  "Name": "webacl-alb-echo",
  "Id": "654c5d0a-6f33-48e1-bec6-fbe4d9f978d2",
  "ARN": "arn:aws:wafv2:us-east-1:668876233624:regional/webacl/webacl-alb-echo/654c5d0a-6f33-48e1-bec6-fbe4d9f978d2",
  "DefaultAction": {
    "Allow": {}
  },
  "Description": "",
  "Rules": [
    {
      "Name": "rate-limit-all",
      "Priority": 0,
      "Statement": {
        "RateBasedStatement": {
          "Limit": 10000,
          "EvaluationWindowSec": 300,
          "AggregateKeyType": "IP"
        }
      },
      "Action": {
        "Block": {
          "CustomResponse": {
            "ResponseCode": 413,
            "CustomResponseBodyKey": "block-by-waf"
          }
        }
      },
      "RuleLabels": [
        {
          "Name": "ratelimit:all"
        }
      ],
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "rate-limit-all"
      }
    },
    {
      "Name": "commandi",
      "Priority": 1,
      "Statement": {
        "OrStatement": {
          "Statements": [
            {
              "RegexMatchStatement": {
                "RegexString": ".*(;|\\||\\&)\\s*(ls|cd|pwd|mkdir|rmdir|touch|rm|cp|mv|cat|more|less|head|tail|grep|find|chmod|chown|ps|kill|top|df|du|tar|zip|unzip|ping|ssh|scp|wget|curl|ifconfig|alias).*",
                "FieldToMatch": {
                  "QueryString": {}
                },
                "TextTransformations": [
                  {
                    "Priority": 0,
                    "Type": "URL_DECODE_UNI"
                  }
                ]
              }
            },
            {
              "RegexMatchStatement": {
                "RegexString": ".*(;|\\||\\&)\\s*(ls|cd|pwd|mkdir|rmdir|touch|rm|cp|mv|cat|more|less|head|tail|grep|find|chmod|chown|ps|kill|top|df|du|tar|zip|unzip|ping|ssh|scp|wget|curl|ifconfig|alias).*",
                "FieldToMatch": {
                  "Body": {
                    "OversizeHandling": "CONTINUE"
                  }
                },
                "TextTransformations": [
                  {
                    "Priority": 0,
                    "Type": "UTF8_TO_UNICODE"
                  }
                ]
              }
            }
          ]
        }
      },
      "Action": {
        "Block": {
          "CustomResponse": {
            "ResponseCode": 403,
            "CustomResponseBodyKey": "block-by-waf"
          }
        }
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "commandi"
      }
    },
    {
      "Name": "file-upload",
      "Priority": 2,
      "Statement": {
        "AndStatement": {
          "Statements": [
            {
              "ByteMatchStatement": {
                "SearchString": "post",
                "FieldToMatch": {
                  "Method": {}
                },
                "TextTransformations": [
                  {
                    "Priority": 0,
                    "Type": "LOWERCASE"
                  }
                ],
                "PositionalConstraint": "EXACTLY"
              }
            },
            {
              "OrStatement": {
                "Statements": [
                  {
                    "RegexMatchStatement": {
                      "RegexString": ".*\\.(?:php\\d*|jsp|asp|pht|phtml|shtml|asa|cer|asax|swf|xap|htaccess|config)\\.*",
                      "FieldToMatch": {
                        "Body": {
                          "OversizeHandling": "CONTINUE"
                        }
                      },
                      "TextTransformations": [
                        {
                          "Priority": 0,
                          "Type": "LOWERCASE"
                        }
                      ]
                    }
                  },
                  {
                    "RegexMatchStatement": {
                      "RegexString": ".*\\.(?:php\\d*|jsp|asp|pht|phtml|shtml|asa|cer|asax|swf|xap|htaccess|config)\\.*$",
                      "FieldToMatch": {
                        "AllQueryArguments": {}
                      },
                      "TextTransformations": [
                        {
                          "Priority": 0,
                          "Type": "LOWERCASE"
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "Action": {
        "Block": {
          "CustomResponse": {
            "ResponseCode": 403,
            "CustomResponseBodyKey": "block-by-waf"
          }
        }
      },
      "RuleLabels": [
        {
          "Name": "custom:upload-rule"
        }
      ],
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "file-upload"
      }
    },
    {
      "Name": "sqli_prevention",
      "Priority": 3,
      "Statement": {
        "SqliMatchStatement": {
          "FieldToMatch": {
            "AllQueryArguments": {}
          },
          "TextTransformations": [
            {
              "Priority": 0,
              "Type": "URL_DECODE"
            },
            {
              "Priority": 1,
              "Type": "URL_DECODE_UNI"
            }
          ],
          "SensitivityLevel": "HIGH"
        }
      },
      "Action": {
        "Block": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "sqli_prevention"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesBotControlRuleSet",
      "Priority": 4,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesBotControlRuleSet",
          "ManagedRuleGroupConfigs": [
            {
              "AWSManagedRulesBotControlRuleSet": {
                "InspectionLevel": "TARGETED",
                "EnableMachineLearning": true
              }
            }
          ],
          "RuleActionOverrides": [
            {
              "Name": "CategoryAdvertising",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryArchiver",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryContentFetcher",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryEmailClient",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryHttpLibrary",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryLinkChecker",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryMiscellaneous",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryMonitoring",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryScrapingFramework",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategorySearchEngine",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategorySecurity",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategorySeo",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategorySocialMedia",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "CategoryAI",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "SignalAutomatedBrowser",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "SignalKnownBotDataCenter",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "SignalNonBrowserUserAgent",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "TGT_VolumetricIpTokenAbsent",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "TGT_VolumetricSession",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "TGT_SignalAutomatedBrowser",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "TGT_SignalBrowserInconsistency",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "TGT_TokenReuseIp",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "TGT_ML_CoordinatedActivityMedium",
              "ActionToUse": {
                "Count": {}
              }
            },
            {
              "Name": "TGT_ML_CoordinatedActivityHigh",
              "ActionToUse": {
                "Count": {}
              }
            }
          ]
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesBotControlRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesAdminProtectionRuleSet",
      "Priority": 5,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesAdminProtectionRuleSet"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesAdminProtectionRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesAmazonIpReputationList",
      "Priority": 6,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesAmazonIpReputationList"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesAmazonIpReputationList"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesAnonymousIpList",
      "Priority": 7,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesAnonymousIpList"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesAnonymousIpList"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesCommonRuleSet",
      "Priority": 8,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesCommonRuleSet",
          "RuleActionOverrides": [
            {
              "Name": "NoUserAgent_HEADER",
              "ActionToUse": {
                "Count": {}
              }
            }
          ]
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesCommonRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesKnownBadInputsRuleSet",
      "Priority": 9,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesKnownBadInputsRuleSet",
          "Version": "Version_1.17"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesKnownBadInputsRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesLinuxRuleSet",
      "Priority": 10,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesLinuxRuleSet",
          "Version": "Version_2.2"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesLinuxRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesPHPRuleSet",
      "Priority": 11,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesPHPRuleSet"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesPHPRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesUnixRuleSet",
      "Priority": 12,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesUnixRuleSet"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesUnixRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesSQLiRuleSet",
      "Priority": 13,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesSQLiRuleSet",
          "Version": "Version_2.0"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesSQLiRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesWindowsRuleSet",
      "Priority": 14,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesWindowsRuleSet"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesWindowsRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesWordPressRuleSet",
      "Priority": 15,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesWordPressRuleSet"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesWordPressRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesATPRuleSet",
      "Priority": 16,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesATPRuleSet",
          "ManagedRuleGroupConfigs": [
            {
              "AWSManagedRulesATPRuleSet": {
                "LoginPath": "/web/login",
                "RequestInspection": {
                  "PayloadType": "JSON",
                  "UsernameField": {
                    "Identifier": "/form/username"
                  },
                  "PasswordField": {
                    "Identifier": "/form/password"
                  }
                },
                "EnableRegexInPath": false
              }
            }
          ]
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesATPRuleSet"
      }
    },
    {
      "Name": "AWS-AWSManagedRulesACFPRuleSet",
      "Priority": 17,
      "Statement": {
        "ManagedRuleGroupStatement": {
          "VendorName": "AWS",
          "Name": "AWSManagedRulesACFPRuleSet",
          "ManagedRuleGroupConfigs": [
            {
              "AWSManagedRulesACFPRuleSet": {
                "CreationPath": "/web/singup/submit-registration",
                "RegistrationPagePath": "/web/signup/registration",
                "RequestInspection": {
                  "PayloadType": "JSON",
                  "UsernameField": {
                    "Identifier": "/form/username"
                  },
                  "PasswordField": {
                    "Identifier": "/form/password"
                  },
                  "EmailField": {
                    "Identifier": "/form/email"
                  }
                },
                "EnableRegexInPath": false
              }
            }
          ]
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "AWS-AWSManagedRulesACFPRuleSet"
      }
    },
    {
      "Name": "test_RG",
      "Priority": 18,
      "Statement": {
        "RuleGroupReferenceStatement": {
          "ARN": "arn:aws:wafv2:us-east-1:652875617673:global/rulegroup/waf-automation-global-region-rulegroup1/03531fc3-6800-4fe8-83c0-b7f8f903c45d"
        }
      },
      "OverrideAction": {
        "None": {}
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "test_RG"
      }
    },
    {
      "Name": "login_rate_limit",
      "Priority": 19,
      "Statement": {
        "RateBasedStatement": {
          "Limit": 100,
          "EvaluationWindowSec": 300,
          "AggregateKeyType": "IP",
          "ScopeDownStatement": {
            "OrStatement": {
              "Statements": [
                {
                  "ByteMatchStatement": {
                    "SearchString": "/v2/passport/login_sec",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "EXACTLY"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/v2/aiassis/get_donation_history",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "EXACTLY"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/aiassis/get_donation_history",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "ENDS_WITH"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/web/passport/profile",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "ENDS_WITH"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/web/logging/ping",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "ENDS_WITH"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/v1/app/cipher/get_ciphers",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "EXACTLY"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/v1/app/update_devs_info",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "EXACTLY"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/v2/web/passport/profile",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "EXACTLY"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/passport/login",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "ENDS_WITH"
                  }
                },
                {
                  "ByteMatchStatement": {
                    "SearchString": "/house/device_list",
                    "FieldToMatch": {
                      "UriPath": {}
                    },
                    "TextTransformations": [
                      {
                        "Priority": 0,
                        "Type": "NONE"
                      }
                    ],
                    "PositionalConstraint": "ENDS_WITH"
                  }
                }
              ]
            }
          }
        }
      },
      "Action": {
        "Block": {}
      },
      "RuleLabels": [
        {
          "Name": "Ratelimit-Login:Block"
        }
      ],
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "login_rate_limit"
      }
    },
    {
      "Name": "google-bot",
      "Priority": 20,
      "Statement": {
        "LabelMatchStatement": {
          "Scope": "LABEL",
          "Key": "awswaf:managed:aws:bot-control:bot:name:googlebot"
        }
      },
      "Action": {
        "Allow": {
          "CustomRequestHandling": {
            "InsertHeaders": [
              {
                "Name": "category",
                "Value": "googlebot"
              }
            ]
          }
        }
      },
      "VisibilityConfig": {
        "SampledRequestsEnabled": true,
        "CloudWatchMetricsEnabled": true,
        "MetricName": "google-bot"
      }
    }
  ],
  "VisibilityConfig": {
    "SampledRequestsEnabled": true,
    "CloudWatchMetricsEnabled": true,
    "MetricName": "webacl-alb-echo"
  },
  "Capacity": 2276,
  "ManagedByFirewallManager": false,
  "LabelNamespace": "awswaf:668876233624:webacl:webacl-alb-echo:",
  "CustomResponseBodies": {
    "block-by-waf": {
      "ContentType": "APPLICATION_JSON",
      "Content": "{\n\"error\": \"blocked by waf\"\n}"
    }
  }
}